#!/bin/bash

set -e

shopt -s dotglob
echo "---> Installing application source..."
mkdir /tmp/src/bin

php -r "readfile('http://files.drush.org/drush.phar');" > /tmp/src/bin/drush
chmod +x /tmp/src/bin/drush
mv /tmp/src/* ./

# Install Composer
curl https://getcomposer.org/installer | php

# Install App dependencies using Composer
./composer.phar global require drush/drush --no-interaction --no-ansi --optimize-autoloader
PATH="./.composer/vendor/bin:$PATH"

# Fix source directory permissions
fix-permissions ./
